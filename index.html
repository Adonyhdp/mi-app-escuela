<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mi-App-Escuela</title>

  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #4facfe, #00f2fe);
      margin: 0;
      padding: 0;
    }

    header {
      background: #283e51;
      color: #fff;
      padding: 20px;
      text-align: center;
      font-size: 26px;
      font-weight: bold;
      letter-spacing: 1px;
    }

    /* LOGIN */
    .login-box {
      background: #fff;
      width: 350px;
      margin: 80px auto;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      text-align: center;
      animation: fadeIn 0.6s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .login-box h2 {
      margin-bottom: 20px;
      color: #333;
    }

    input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 15px;
    }

    button {
      width: 100%;
      padding: 12px;
      background: #4facfe;
      border: none;
      color: #fff;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      transition: 0.3s;
    }

    button:hover {
      background: #00c6fb;
    }

    /* CONTENIDO INTERNO */
    .tabs {
      display: none;
      padding: 20px;
      animation: fadeIn 0.5s ease;
    }

    .tab-buttons {
      margin-bottom: 20px;
      text-align: center;
    }

    .tab-buttons button {
      margin: 5px;
      padding: 10px 15px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      background: #eee;
      font-size: 15px;
    }

    .tab-buttons button.active {
      background: #4facfe;
      color: #fff;
    }

    .tab-content {
      display: none;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      animation: fadeIn 0.5s ease;
    }

    .tab-content.active {
      display: block;
    }

    .list {
      list-style: none;
      padding: 0;
    }

    .list li {
      padding: 10px;
      border-bottom: 1px solid #ddd;
      cursor: pointer;
      font-size: 16px;
    }

    .list li:hover {
      background: #f0f8ff;
    }
  </style>
</head>

<body>

<header>ðŸ“˜ Mi-App-Escuela</header>

<!-- LOGIN -->
<div class="login-box" id="loginBox">
  <h2>Ingreso</h2>
  <input type="text" id="email" placeholder="Correo">
  <input type="password" id="password" placeholder="ContraseÃ±a">
  <button onclick="login()">Entrar</button>
</div>

<!-- CONTENIDO INTERNO -->
<div class="tabs" id="tabs">

  <div class="tab-buttons">
    <button onclick="openTab('escuelas')" class="active">Escuelas</button>
    <button onclick="openTab('liceos')">Liceos</button>
  </div>

  <!-- Escuelas -->
  <div id="escuelas" class="tab-content active">
    <h3>Escuelas</h3>
    <ul class="list" id="escuelasList"></ul>
  </div>

  <!-- Liceos -->
  <div id="liceos" class="tab-content">
    <h3>Liceos</h3>
    <ul class="list" id="liceosList"></ul>
  </div>

  <!-- Salones -->
  <div id="salones" class="tab-content">
    <h3>Salones / Aulas</h3>
    <ul class="list" id="salonesList"></ul>
  </div>

  <!-- Estudiantes -->
  <div id="estudiantes" class="tab-content">
    <h3>Estudiantes</h3>
    <ul class="list" id="estudiantesList"></ul>
  </div>

  <!-- Datos del estudiante -->
  <div id="datos" class="tab-content">
    <h3>Datos del Estudiante</h3>
    <div id="datosContent"></div>
  </div>

</div>

<script>

  /* âœ… USUARIOS DE EJEMPLO (luego se conectarÃ¡n a Google Sheets) */
  const users = {
    "admin@gmail.com": {password: "1234", role: "admin"},
    "profe@gmail.com": {password: "1234", role: "profesor"},
    "padre@gmail.com": {password: "1234", role: "representante"}
  };

  /* âœ… DATOS FICTICIOS (serÃ¡n reemplazados por Google Sheets en la Parte 3) */
  const escuelas = ["Escuela Primaria BolÃ­var", "Escuela SimÃ³n RodrÃ­guez"];
  const liceos = ["Liceo Libertador", "Liceo San MartÃ­n"];
  const salones = Array.from({length: 40}, (_, i) => `SalÃ³n ${i+1}`);

  const estudiantes = Array.from({length: 40}, (_, i) => ({
    nombre: `Estudiante ${i+1}`,
    apellido: `Apellido ${i+1}`,
    edad: 10 + (i % 10),
    peso: 30 + i,
    entrada: "7:00 AM",
    salida: "1:00 PM",
    notas: {
      matematicas: Math.floor(Math.random()*20),
      historia: Math.floor(Math.random()*20),
      ciencias: Math.floor(Math.random()*20),
      educacionFisica: Math.floor(Math.random()*20)
    }
  }));


  /* âœ… FUNCIÃ“N DE LOGIN */
  function login() {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    if(users[email] && users[email].password === password) {

      // Ocultar login
      document.getElementById("loginBox").style.display = "none";

      // Mostrar pestaÃ±as
      document.getElementById("tabs").style.display = "block";

      // Cambiar encabezado
      document.querySelector("header").innerHTML =
        "ðŸ“˜ Mi-App-Escuela â€” Bienvenido: " + users[email].role.toUpperCase();

      // Cargar listas
      loadLists();

    } else {
      alert("Correo o contraseÃ±a incorrectos");
    }
  }


  /* âœ… CAMBIO DE PESTAÃ‘AS */
  function openTab(tabName) {
    const contents = document.querySelectorAll(".tab-content");
    const buttons = document.querySelectorAll(".tab-buttons button");

    contents.forEach(c => c.classList.remove("active"));
    buttons.forEach(b => b.classList.remove("active"));

    document.getElementById(tabName).classList.add("active");
    event.target.classList.add("active");
  }


  /* âœ… CARGAR LISTAS DE ESCUELAS, LICEOS Y SALONES (FICTICIAS POR AHORA) */
  function loadLists() {

    // Escuelas
    const escuelasList = document.getElementById("escuelasList");
    escuelasList.innerHTML = "";
    escuelas.forEach(e => {
      const li = document.createElement("li");
      li.textContent = e;
      li.onclick = () => openTab("salones");
      escuelasList.appendChild(li);
    });

    // Liceos
    const liceosList = document.getElementById("liceosList");
    liceosList.innerHTML = "";
    liceos.forEach(l => {
      const li = document.createElement("li");
      li.textContent = l;
      li.onclick = () => openTab("salones");
      liceosList.appendChild(li);
    });

    // Salones
    const salonesList = document.getElementById("salonesList");
    salonesList.innerHTML = "";
    salones.forEach(s => {
      const li = document.createElement("li");
      li.textContent = s;
      li.onclick = () => {
        openTab("estudiantes");
        loadEstudiantes(); // âœ… Esto se reemplaza en la Parte 3
      };
      salonesList.appendChild(li);
    });
  }


  /* âœ… CARGAR ESTUDIANTES (FICTICIOS POR AHORA) */
  function loadEstudiantes() {
    const estudiantesList = document.getElementById("estudiantesList");
    estudiantesList.innerHTML = "";

    estudiantes.forEach(est => {
      const li = document.createElement("li");
      li.textContent = est.nombre + " " + est.apellido;
      li.onclick = () => showDatos(est);
      estudiantesList.appendChild(li);
    });
  }


  /* âœ… MOSTRAR DATOS DEL ESTUDIANTE */
  function showDatos(est) {
    openTab("datos");

    const datosContent = document.getElementById("datosContent");

    datosContent.innerHTML = `
      <p><b>Nombre:</b> ${est.nombre} ${est.apellido}</p>
      <p><b>Edad:</b> ${est.edad}</p>
      <p><b>Peso:</b> ${est.peso} kg</p>
      <p><b>Entrada:</b> ${est.entrada}</p>
      <p><b>Salida:</b> ${est.salida}</p>

      <h4>Calificaciones:</h4>
      <ul>
        <li>MatemÃ¡ticas: ${est.notas.matematicas}</li>
        <li>Historia: ${est.notas.historia}</li>
        <li>Ciencias: ${est.notas.ciencias}</li>
        <li>EducaciÃ³n FÃ­sica: ${est.notas.educacionFisica}</li>
      </ul>

      <p><b>Aprobaciones:</b> ${
        Object.values(est.notas).filter(n => n >= 10).length
      } materias</p>

      <p><b>Reprobaciones:</b> ${
        Object.values(est.notas).filter(n => n < 10).length
      } materias</p>
    `;
  }
    /* âœ… PARTE 3 â€” CONEXIÃ“N REAL CON GOOGLE SHEETS */

  // âœ… ID de tu hoja (NO LO CAMBIES)
  const sheetID = "1EG53O1aC3NqZIFvYmlewjMQboJ5wOGjP89UUC_Gf1-I";

  // âœ… URL para leer datos en formato JSON
  const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

  // âœ… PROBAR CONEXIÃ“N
  async function leerGoogleSheet() {
    try {
      const respuesta = await fetch(sheetURL);
      const texto = await respuesta.text();

      // Google envÃ­a basura antes y despuÃ©s del JSON â†’ lo limpiamos
      const json = JSON.parse(texto.substring(47, texto.length - 2));

      console.log("âœ… Conectado a Google Sheets");
      console.log(json);

    } catch (error) {
      console.error("âŒ Error leyendo Google Sheets:", error);
    }
  }

  // âœ… LLAMAR A LA FUNCIÃ“N APENAS ENTRE AL SISTEMA
  leerGoogleSheet();



  /* âœ… LEER PESTAÃ‘A ESTUDIANTES Y MOSTRARLA EN LA WEB */

  async function cargarEstudiantesReales() {
    const respuesta = await fetch(sheetURL);
    const texto = await respuesta.text();
    const json = JSON.parse(texto.substring(47, texto.length - 2));

    const filas = json.table.rows;

    // Limpiar lista
    const lista = document.getElementById("estudiantesList");
    lista.innerHTML = "";

    filas.forEach(fila => {
      if (!fila.c[0]) return; // Saltar filas vacÃ­as

      const nombre = fila.c[0]?.v || "";
      const apellido = fila.c[1]?.v || "";
      const edad = fila.c[2]?.v || "";
      const peso = fila.c[3]?.v || "";
      const entrada = fila.c[4]?.v || "";
      const salida = fila.c[5]?.v || "";
      const matematicas = fila.c[6]?.v || "";
      const historia = fila.c[7]?.v || "";
      const ciencias = fila.c[8]?.v || "";
      const educacionFisica = fila.c[9]?.v || "";

      // Crear item en la lista
      const li = document.createElement("li");
      li.textContent = nombre + " " + apellido;

      // Al hacer clic, mostrar datos reales
      li.onclick = () => {
        openTab("datos");
        document.getElementById("datosContent").innerHTML = `
          <p><b>Nombre:</b> ${nombre} ${apellido}</p>
          <p><b>Edad:</b> ${edad}</p>
          <p><b>Peso:</b> ${peso} kg</p>
          <p><b>Entrada:</b> ${entrada}</p>
          <p><b>Salida:</b> ${salida}</p>

          <h4>Calificaciones:</h4>
          <ul>
            <li>MatemÃ¡ticas: ${matematicas}</li>
            <li>Historia: ${historia}</li>
            <li>Ciencias: ${ciencias}</li>
            <li>EducaciÃ³n FÃ­sica: ${educacionFisica}</li>
          </ul>
        `;
      };

      lista.appendChild(li);
    });
      }
    /* âœ… PARTE 4 â€” LEER ESCUELAS, LICEOS Y HORARIOS REALES DESDE GOOGLE SHEETS */


  /* âœ… LEER PESTAÃ‘A ESCUELAS (columna A) */
  async function cargarEscuelasReales() {
    const respuesta = await fetch(sheetURL);
    const texto = await respuesta.text();
    const json = JSON.parse(texto.substring(47, texto.length - 2));

    const filas = json.table.rows;
    const lista = document.getElementById("escuelasList");
    lista.innerHTML = "";

    filas.forEach(fila => {
      const escuela = fila.c[10]?.v; // Ajusta segÃºn tu hoja
      if (!escuela) return;

      const li = document.createElement("li");
      li.textContent = escuela;
      li.onclick = () => openTab("salones");
      lista.appendChild(li);
    });
  }



  /* âœ… LEER PESTAÃ‘A LICEOS (columna B o C segÃºn tu hoja) */
  async function cargarLiceosReales() {
    const respuesta = await fetch(sheetURL);
    const texto = await respuesta.text();
    const json = JSON.parse(texto.substring(47, texto.length - 2));

    const filas = json.table.rows;
    const lista = document.getElementById("liceosList");
    lista.innerHTML = "";

    filas.forEach(fila => {
      const liceo = fila.c[11]?.v; // Ajusta segÃºn tu hoja
      if (!liceo) return;

      const li = document.createElement("li");
      li.textContent = liceo;
      li.onclick = () => openTab("salones");
      lista.appendChild(li);
    });
  }



  /* âœ… LEER PESTAÃ‘A HORARIOS (salÃ³n, entrada, salida) */
  async function cargarHorariosReales() {
    const respuesta = await fetch(sheetURL);
    const texto = await respuesta.text();
    const json = JSON.parse(texto.substring(47, texto.length - 2));

    const filas = json.table.rows;
    const lista = document.getElementById("salonesList");
    lista.innerHTML = "";

    filas.forEach(fila => {
      const salon = fila.c[10]?.v; // Ajusta segÃºn tu hoja
      if (!salon) return;

      const li = document.createElement("li");
      li.textContent = salon;

      li.onclick = () => {
        openTab("estudiantes");
        cargarEstudiantesReales();
      };

      lista.appendChild(li);
    });
  }



  /* âœ… REEMPLAZAR LISTAS FICTICIAS POR LISTAS REALES */
  async function loadLists() {
    await cargarEscuelasReales();
    await cargarLiceosReales();
    await cargarHorariosReales();
  }

</script>

</body>
</html>

  
